<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zzy.malladmin.dao.OmsCartItemDao">
    <resultMap id="CartProductMap" type="com.zzy.malladmin.dto.CartProduct" extends="com.zzy.malladmin.mbg.mapper.PmsProductMapper.BaseResultMap">
        <collection property="productAttributeList" columnPrefix="attr_" resultMap="com.zzy.malladmin.mbg.mapper.PmsProductAttributeMapper.BaseResultMap" />
        <collection property="skuStockList" columnPrefix="sku_" resultMap="com.zzy.malladmin.mbg.mapper.PmsSkuStockMapper.BaseResultMap" />
    </resultMap>
    <select id="getProduct" resultMap="CartProductMap" >
        select
            p.*,
            pa.id attr_id,
            pa.product_attribute_category_id attr_product_attribute_category_id,
            pa.name attr_name,
               pa.select_type attr_select_type,
               pa.input_type attr_type,
               pa.input_list attr_input_list,
               pa.sort attr_sort,
               pa.filter_type attr_filter_type,
               pa.search_type attr_search_type,
               pa.related_status attr_related_status,
               pa.hand_add_status attr_hand_add_status,
               pa.type attr_type,
            ss.id sku_id,
            ss.product_id sku_product_id,
            ss.sku_code sku_sku_code,
               ss.price sku_price,
               ss.stock sku_stock,
               ss.low_stock sku_low_stock,
               ss.pic sku_pic,
               ss.sale sku_sale,
               ss.promotion_price sku_promotion_price,
               ss.lock_stock,
               ss.sp_data sp_sp_data
        from pms_product p
        left join pms_product_category_attribute_relation pcar on p.product_category_id = pcar.product_category_id
        left join pms_product_attribute pa on pa.id = pcar.product_attribute_id
        left join pms_sku_stock ss on ss.product_id = p.id
        where p.id = #{productId}
    </select>
</mapper>